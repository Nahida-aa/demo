<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    *{
    margin: 0;
    padding: 0;
}
body{
    background: #333;
    overflow: hidden;
}
.main {
    position: fixed;
    width: 100%;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
}
#canvas{
    filter: drop-shadow(0 0 1px white);
}
  </style>
  <title>Document</title>
</head>
<body>
  <div class="main">
    <canvas id="canvas"></canvas>
  </div>
</body>
</html>
<script>
let canvas = document.getElementById('canvas');
let ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
let meteors = [];
let allstar = 40
function init() {
  for (let i = 0; i < allstar; i++) {
    newmeteor();
  }
}
function newmeteor() {
    meteors.push({
        lines: [{
            x: parseInt(Math.random() * canvas.width),
            y: parseInt(Math.random() * canvas.height*0.7),
        }],
        life: parseInt(Math.random() * 100)+100,
        age:0
    });
  }
function draw() {
	ctx.clearRect(0, 0, canvas.width, canvas.height);
	for (let i = 0; i < meteors.length; i++) {
		let meteor = meteors[i];
		lines = meteor.lines;
		for (let j = 0; j < lines.length; j++) {
			// 拖尾上每个点的不透明度 0~1
			ctx.fillStyle = `rgba(255,255,255,${j / meteor.life})`;
			ctx.fillRect(lines[j].x, lines[j].y, 1, 1);
		}
		ctx.fillStyle = 'yellow';
		let s_head = lines[lines.length - 1];
		ctx.fillRect(s_head.x, s_head.y, 2, 2);
	//   在流星还在生命周期的一半时，随机增加流星的尾巴长度
		if (meteor.age <= meteor.life/2) {
			meteor.lines.push({
				// x: s_head.x + (Math.random() - 0.5) * 2,
				x: s_head.x + 1,
				// y: s_head.y + (Math.random() - 0.5) * 2
				y: s_head.y + 0.3
			});
		} else {// 在流星生命周期的后半段，流星的尾巴长度逐渐减小
			meteor.lines.shift();
		}
		meteor.age++;
		if (meteor.age >= meteor.life) {
			meteors.splice(i, 1);
			newmeteor();
		}
	}
}
init();
setInterval(draw, 1);
</script>